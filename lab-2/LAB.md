# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2
---
__–û—Å–Ω–æ–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ__

–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ 500 –≤—ã–±–æ—Ä–æ–∫ –æ–±—ä–µ–º–∞ 50 —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ ùúÉ. –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ—Ü–µ–Ω–∫–∞ –æ—Ç–∫–ª–æ–Ω–∏—Ç—Å—è –æ—Ç –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 0.01? –¢–æ –∂–µ —Å–∞–º–æ–µ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –æ–±—ä–µ–º–æ–≤ –≤—ã–±–æ—Ä–∫–∏ 100, 500, 1000, 2500. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ö–∞–∫ –æ–±—ä—è—Å–Ω–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç?

---
### –ó–∞–¥–∞–Ω–∏–µ ‚Ññ5

__–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:__

–ù–∞–π—Ç–∏ –æ—Ü–µ–Ω–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\theta$ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é:

<tex>$$f_{\theta}(x) = {{3x^2}\over{\sqrt{2\pi}}}exp(-{{(\theta-x^3)}^2\over{2}})$$<tex>

–Ω–∞–π—Ç–∏ –µ—ë —Å–º–µ—â–µ–Ω–∏–µ, –¥–∏—Å–ø–µ—Ä—Å–∏—é –∏ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É. –ö–∞–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –æ–±–ª–∞–¥–∞–µ—Ç –¥–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞? –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø—Ä–∏ $\theta = 5$.

__–†–µ—à–µ–Ω–∏–µ:__

–î–ª—è –Ω–∞—á–∞–ª–∞ –≤—ã–≤–µ–¥–µ–º —Ñ–æ—Ä–º—É–ª—É –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –¥–∞–Ω–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é.

–ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—é

<tex>$$\prod_{i=1}^n = {{3x_1^2\cdot3x_2^2\cdot...\cdot3x_n^2}\over{\sqrt{2\pi}\cdot \sqrt{2\pi}\cdot...\cdot\sqrt{2\pi}}} \cdot \exp \Biggl(\Biggl(-{{(\theta - x_1^3)^2}\over{2}}\Biggr)\cdot\Biggl(-{{(\theta - x_2^3)^2}\over{2}}\Biggr)\cdot...\cdot\Biggl(-{{(\theta - x_n^3)^2}\over{2}}\Biggr)\Biggr)=$$<tex>

<tex>$$={{3^n\cdot\prod\nolimits_{i=1}^n x_i^2}\over{(2\pi)^{{n}\over{2}}}}\cdot\exp\Biggl(\Biggl(-{{1}\over{2}}\Biggr)^n\cdot\prod_{i=1}^n(\theta-x_i^3)^2\Biggr)=\ln\Biggl({{3^n\cdot\sum\nolimits_{i=1}^n x_i^2}\over{(2\pi)^{{n}\over{2}}}}\cdot\exp\Biggl(\Biggl(-{{1}\over{2}}\Biggr)^n\cdot\sum_{i=1}^n(\theta-x_i^3)^2\Biggr)\Biggr)=$$<tex>

<tex>$$=\ln3^n+\ln\sum_{i=1}^nx_i^2-{{n}\over{2}}\ln(2\pi)+\Bigl(-{{1}\over{2}}\Bigr)^n\cdot\sum_{i=1}^n(\theta - x_i^3)^2=$$<tex>

–æ—Ü–µ–Ω–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è

<tex>$${{\mathrm{d}(\ln3^n+2\ln\sum\nolimits_{i=1}^nx_i-{{n}\over{2}}\ln(2\pi)+\Bigl(-{{1}\over{2}}\Bigr)^n\cdot\sum\nolimits_{i=1}^n(\theta - x_i^3)^2)}\over{\mathrm{d}\theta}}=$$<tex>

<tex>$$=\Bigl(-{{1}\over{2}}\Bigr)^n\cdot\Bigl(\sum_{i=1}^n(\theta - x_i^3)^2\Bigr)_\theta'=\Bigl(-{{1}\over{2}}\Bigr)^n\cdot\Bigl(\sum_{i=1}^n2(\theta - x_i^3)\Bigr)$$<tex>

–ø—Ä–∏—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∫ –Ω—É–ª—é

<tex>$$\Bigl(-{{1}\over{2}}\Bigr)^n\cdot\Bigl(\sum_{i=1}^n2(\theta - x_i^3)\Bigr) = 0,$$<tex>

—Ç–∞–∫ –∫–∞–∫ $\Bigl(-{{1}\over{2}}\Bigr)^n \neq 0 \Longrightarrow \sum\nolimits_{i=1}^n2(\theta - x_i^3) = 0 \Longrightarrow \theta = \overline{X}^3$ 

__–Ω–∞–π–¥–µ–º —Å–º–µ—â–µ–Ω–∏–µ__

–Ω–∞–π–¥–µ–º –º–∞—Ç–∏–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ

–¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –¥–ª—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ $f_{\theta}(x)$ —Å –æ—Ü–µ–Ω–∫–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è $\overline{x}^3$ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º $\theta_0$, –Ω—É–∂–Ω–æ –≤–∑—è—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞–ª:


<tex>$$E[\overline{x}^3] = \int_{-\infty}^{\infty}x^3 f_{\theta_0}(x) dx = \int_{-\infty}^{\infty}x^3 {{3x^2}\over{\sqrt{2\pi}}}exp(-{{(\theta_0-x^3)}^2\over{2}}) dx$$<tex>

–∑–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä $\theta_0 = 5$

–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ —Å–º–µ—â–µ–Ω–∏–µ

<tex>$$E[\overline{x}^3]‚àíŒ∏_0$$<tex>

–∫–æ–¥:
```python
def bias(theta_0, x):
    func = lambda x, theta: 3 * x ** 2 / np.sqrt(2 * np.pi) * np.exp(-0.5 * (theta - x ** 3) ** 2)
    int = lambda x: x ** 3 * func(x, theta_0)
    result = quad(int, -np.inf, np.inf)[0]
    return result - theta_0
```

__–Ω–∞–π–¥–µ–º –¥–∏—Å–ø–µ—Ä—Å–∏—é__

—Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏

<tex>$$Var(\hat{\theta}) = E[\hat\theta^2]-(E[\hat\theta])^2,$$<tex>

–≥–¥–µ –≥–¥–µ $\hat{\theta} = \overline{x}^3$ - –æ—Ü–µ–Ω–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è, $E[\hat{\theta}]$ - –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è, –∞ $E[\hat{\theta}^2]$ - –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–∞ –æ—Ü–µ–Ω–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è.

—Ä–∞–Ω–µ–µ –º—ã —É–∂–µ –Ω–∞—Ö–æ–¥–∏–ª–∏ –º–∞—Ç –æ–∂–∏–¥–∞–Ω–∏–µ, –ø–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω–∞–¥–æ –Ω–∞–π—Ç–∏ —Ç–æ–ª—å–∫–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–∞ –æ—Ü–µ–Ω–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è.

—Ñ–æ—Ä–º—É–ª–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è –∫–≤–∞–¥—Ä–∞—Ç–∞ –æ—Ü–µ–Ω–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è.

<tex>$$E[\hat\theta^2] = \int_{-\infty}^{\infty}\hat\theta^2 f_{\theta_0}(x) dx$$<tex>

–∫–æ–¥:
```python
def var(theta_0, x):
    b = bias(theta_0**2, x)
    return b - bias(theta_0, x)**2
```

__–Ω–∞–π–¥–µ–º —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É__

<tex>$$MSE(\hat\theta) = E[(\hat\theta - \theta_0)^2] = E[\hat\theta^2 - 2\hat\theta\theta_0 + \theta_0^2] = $$<tex>

<tex>$$=E[\hat\theta^2]-2\theta E[\hat\theta]+\theta^2=E[\hat\theta^2]-E[\hat\theta]^2+E[\hat\theta]^2-2\hat\theta\theta_0 + \theta^2=$$<tex>

<tex>$$Var(\hat\theta) + (E[\hat\theta]-\theta)^2 = Var(\hat\theta) + Bias(\hat\theta)^2$$<tex>

–¥–∏—Å–ø–µ—Ä—Å–∏—è –∏ —Å–º–µ—â–µ–Ω–∏–µ —É –Ω–∞—Å –µ—Å—Ç—å

–∫–æ–¥:
```python
def mse(theta_0, x):
    return var(theta_0, x) + bias(theta_0, x)**2
```

__–ö–æ–¥ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è__
```python
theta = 5
count_samples = 500
sample_sizes = [50, 100, 500, 1000, 2500]


dev = []

for sample_size in sample_sizes:
    count = 0
    for i in range(count_samples):
        sample = np.random.normal(loc=theta, size=sample_size)
        mean_sample = np.mean(sample)
        if np.abs(mean_sample - theta) > 0.01:
            count += 1
    dev.append(count)


plt.plot(sample_sizes, dev, 'o-')
plt.xlabel('—Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏')
plt.ylabel('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π')
plt.title('–≥—Ä–∞—Ñ–∏–∫ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –¥–ª—è –µ=0.01)')
plt.show()
```

![1](https://github.com/georgedem975/mathematical_statistics/blob/master/lab-2/assets/Figure_1.png)

### –ó–∞–¥–∞–Ω–∏–µ ‚Ññ6

__–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:__

–° –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –º–æ–º–µ–Ω—Ç–æ–≤ –Ω–∞–π—Ç–∏ –æ—Ü–µ–Ω–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\theta$ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é:

<tex>$$f_{\theta}(x)={{1}\over{(k-1)!\theta^k}}x^{k-1}e^{-x/\theta}\mathbb{1}(x > 0),$$<tex>

–µ—Å–ª–∏ $k \in N - $–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –ö–∞–∫–∏–º–∏–º —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –æ–±–ª–∞–¥–∞–µ—Ç –¥–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞? –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø—Ä–∏ $\theta = 2, k = 3$.

__–†–µ—à–µ–Ω–∏–µ:__


–¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\theta$ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –º–æ–º–µ–Ω—Ç–æ–≤, –Ω—É–∂–Ω–æ –ø—Ä–∏—Ä–∞–≤–Ω—è—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç –ø–æ—Ä—è–¥–∫–∞ $r$ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏) –∏ –µ–≥–æ –≤—ã–±–æ—Ä–æ—á–Ω—ã–π –∞–Ω–∞–ª–æ–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±–æ—Ä–∫–∏ $X_1, X_2, ..., X_n$ –ø–æ—Ä—è–¥–∫–∞ $r$.

<tex>$$E(X^r) = \int_{0}^{\infty} x^r f_{\theta}(x) dx$$<tex>

–∑–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–∞–Ω–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≥–∞–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

<tex>$$E(X) = k\theta, \ \ E(X^2) = (k+1)k\theta^2$$<tex>

–¥–ª—è 1 –∏ 2 –º–æ–º–µ–Ω—Ç–æ–≤:

<tex>$$\overline{X} = E(X) = k\theta$$<tex>

<tex>$${{1}\over{n}} \sum_{i=1}^{n} X_i^2 = E(X^2) = (k+1)k\theta^2$$<tex>

—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:

<tex>$$\theta = {{\overline{X}}\over{k}}$$<tex>

—Å–≤–æ–π—Å—Ç–≤–∞:
1. –Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ—Å—Ç—å
2. —Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
4. –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å

__–ö–æ–¥ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è__

```python
import numpy as np
import matplotlib.pyplot as plt

theta_0 = 2
k = 3

values = [50, 100, 500, 1000, 2500]

e = 0.01

res = []

for n in values:
    dev_count = 0
    for i in range(500):
        X = np.random.gamma(k, theta_0, size=n)
        theta_overline = np.mean(X) / k
        if abs(theta_overline - theta_0) > e:
            dev_count += 1

    res.append(dev_count)


plt.plot(values, res, 'bo-')
plt.xlabel('–†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π')
plt.title('–û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –æ—Ç –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è')
plt.show()
```

![2](https://github.com/georgedem975/mathematical_statistics/blob/master/lab-2/assets/Figure_2.png)

---

__–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ__
–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import quad
```

---

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è:

+ __–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ —Ç–æ—á–µ—á–Ω–æ–≥–æ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤__

+ __–°–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ—Å—Ç—å, –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å__

+ __–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –§–∏—à–µ—Ä–∞, –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –†–∞–æ-–ö—Ä–∞–º–µ—Ä–∞__

+ __–ú–µ—Ç–æ–¥ –º–æ–º–µ–Ω—Ç–æ–≤__

+ __–ú–µ—Ç–æ–¥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è__